<div class="top-margin"></div>

<div class="container">
  <h2>Create Foreign Currency Account</h2>

  <div class="toggle-buttons">
    <button id="clientBtn" class="toggle-btn" [class.active]="accountForm.get('accountType')?.value === 'CLIENT'"
            (click)="accountForm.patchValue({ accountType: 'CLIENT' })">
      Client Checking Account
    </button>
    <button id="businessBtn" class="toggle-btn" [class.active]="accountForm.get('accountType')?.value === 'business'"
            (click)="accountForm.patchValue({ accountType: 'business' })">
      Business Checking Account
    </button>
  </div>

  <form [formGroup]="accountForm" (ngSubmit)="onSubmit()">
    <div class="row">
      <div class="column">
        <h3>Account Owner</h3>
        <app-select label="Select Existing User" formControlName="clientId">
          <option value="">Select User</option>
          <option *ngFor="let user of users" [value]="user.id">{{ user.firstName }} {{ user.lastName }}</option>
        </app-select>

        <app-button (click)="onCreateNewUserClick()" label="Create New User"/>

        <h3>Employee Information</h3>
        <div class="employee-info">
          <p>Logged in employee: <strong>{{ loggedInEmployeeFullName }}</strong> Position: <strong>{{ loggedInEmployeePosition }}</strong></p>
        </div>
      </div>

      <div class="column">
        <h3>Limits and Initial Card</h3>
        <input-text formControlName="dailyLimit" placeholder="Daily Limit" label="Daily Limit" type="number"/>
        <input-text formControlName="monthlyLimit" placeholder="Monthly Limit" label="Monthly Limit" type="number"/>

        <div class="form-group checkbox-group">
          <app-checkbox formControlName="createCard" label="Create initial card"/>
        </div>

        <h3>Account Details</h3>
        <app-select label="Currency" formControlName="currency">
          <option value="">Select Currency</option>
          <option *ngFor="let currency of currencies" [value]="currency.code">{{ currency.name }} ({{ currency.code }})</option>
        </app-select>

        <div *ngIf="isBusinessAccount">
          <h3>Company Information</h3>
          <input-text formControlName="companyName" placeholder="Company Name" label="Company Name"/>
          <input-text formControlName="companyRegistrationNumber" placeholder="Company Registration Number" label="Company Registration Number"/>
          <input-text formControlName="taxIdentificationNumber" placeholder="Tax Identification Number" label="Tax Identification Number"/>
          <input-text formControlName="companyActivityCode" placeholder="Company Activity Code" label="Company Activity Code"/>
          <input-text formControlName="companyAddress" placeholder="Company Address" label="Company Address"/>
          <input-text formControlName="majorityOwnerId" placeholder="Majority Owner ID" label="Majority Owner ID"/>
        </div>
      </div>
    </div>

    <app-button
      type="submit"
      label="Create Account"
      [disabled]="(accountForm.invalid || !isBusinessFormValid() || !accountForm.get('clientId')?.value)"
    />
  </form>
</div>
